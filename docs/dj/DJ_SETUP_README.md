# üéß DJ Set Preparation Guide

–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö DJ-—Å–µ—Ç–æ–≤ –∏–∑ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤** (`yandex-music-downloader`)
- ‚úÖ FLAC lossless –∫–∞—á–µ—Å—Ç–≤–æ
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±–ª–æ–∂–∫–∏ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏
- ‚úÖ –ü–æ–ª–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞–ª—å–±–æ–º, –≥–æ–¥, –ª–µ–π–±–ª)

### 2. **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è DJ** (`reorder_playlist.py`)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É –≤ –ø–ª–µ–π–ª–∏—Å—Ç–µ
- ‚úÖ –ü–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤—Å–µ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ)
- ‚úÖ –ü—Ä–µ—Ñ–∏–∫—Å—ã `01-50` –¥–ª—è —É–¥–æ–±–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### 3. **–°–±–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** (`prepare_dj_set.py`)
- ‚úÖ –ñ–∞–Ω—Ä, –ª–µ–π–±–ª, –¥–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞
- ‚úÖ –ì—Ä–æ–º–∫–æ—Å—Ç—å (LUFS) –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–∑–∏—Ü–∏—è –≤ –ø–ª–µ–π–ª–∏—Å—Ç–µ
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON, CSV, M3U8, TXT

### 4. **–ê–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ** (`analyze_audio.py`)
- ‚úÖ **BPM detection** (librosa)
- ‚úÖ **Key detection** (essentia) —Å Camelot Wheel
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ M3U8 —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫
pip install -U https://github.com/llistochek/yandex-music-downloader/archive/main.zip

# –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞—É–¥–∏–æ
pip install librosa essentia-tensorflow
```

### Workflow

#### –®–∞–≥ 1: –°–∫–∞—á–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç

```bash
yandex-music-downloader \
  --token "YOUR_TOKEN" \
  --playlist-id "250905515/1113" \
  --quality 2 \
  --embed-cover \
  --cover-resolution original \
  --dir ./music_download
```

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å DJ-—Å–µ—Ç

```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ –ø–æ—Ä—è–¥–∫–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞
python reorder_playlist.py "YOUR_TOKEN"

# –°–±–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ Yandex Music API
python prepare_dj_set.py "YOUR_TOKEN"

# –ê–Ω–∞–ª–∏–∑ BPM –∏ Key (–¥–æ–ª–≥–æ - ~5-10 –º–∏–Ω –¥–ª—è 50 —Ç—Ä–µ–∫–æ–≤)
python analyze_audio.py
```

## üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ `dj_set_techno_2025/` –±—É–¥–µ—Ç:

```text
dj_set_techno_2025/
‚îú‚îÄ‚îÄ 01 - Christian Craken - Instinct.m4a
‚îú‚îÄ‚îÄ 02 - Pƒôku - By My Side.m4a
‚îú‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ 50 - Etapp Kyle - Void.m4a
‚îÇ
‚îú‚îÄ‚îÄ tracklist_metadata.json      # –ü–æ–ª–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ tracklist.csv                # –î–ª—è Excel
‚îú‚îÄ‚îÄ tracklist.txt                # –î–ª—è –ø–æ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ techno_2025.m3u8             # –ü–ª–µ–π–ª–∏—Å—Ç —Å BPM/Key
```

### –§–æ—Ä–º–∞—Ç M3U8 –¥–ª—è DJ Pro AI

```text
#EXTM3U
#EXTINF:339,Christian Craken - Instinct
#EXTGENRE:house
#EXTBPM:128.0
#EXTKEY:Am
#EXTCAMELOT:8A
01 - Christian Craken - Instinct.m4a
```

## üìä –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–æ–≤

–ö–∞–∂–¥—ã–π —Ç—Ä–µ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç:

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `artist` | Yandex Music | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å(–∏) |
| `title` | Yandex Music | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞ |
| `album` | Yandex Music | –ê–ª—å–±–æ–º |
| `genre` | Yandex Music | –ñ–∞–Ω—Ä |
| `label` | Yandex Music | –õ–µ–π–±–ª |
| `release_date` | Yandex Music | –î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞ |
| `duration_ms` | Yandex Music | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| `loudness_lufs` | Yandex Music | –ì—Ä–æ–º–∫–æ—Å—Ç—å (LUFS) |
| `bpm` | librosa | –¢–µ–º–ø (—É–¥–∞—Ä—ã –≤ –º–∏–Ω—É—Ç—É) |
| `key` | essentia | –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (C, Am, etc) |
| `camelot` | essentia | Camelot –∫–æ–¥ (8A, 3B, etc) |

## üéõÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ DJ Pro AI

### –ò–º–ø–æ—Ä—Ç –ø–ª–µ–π–ª–∏—Å—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ DJ Pro AI
2. File ‚Üí Import Playlist ‚Üí Choose `techno_2025.m3u8`
3. DJ Pro AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç:
   - BPM –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - Key –¥–ª—è –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –º–∏–∫—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - Genre –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### Harmonic Mixing (Camelot Wheel)

–°–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –º–∏–∫—Å—ã –ø–æ Camelot:
- **–û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–¥**: 8A ‚Üí 8A (–∏–¥–µ–∞–ª—å–Ω–æ)
- **+1/-1**: 8A ‚Üí 7A –∏–ª–∏ 9A (–ø–ª–∞–≤–Ω–æ)
- **–ü–µ—Ä–µ—Ö–æ–¥ A‚ÜîB**: 8A ‚Üî 8B (—Å–º–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è)

–ü—Ä–∏–º–µ—Ä —Ü–µ–ø–æ—á–∫–∏:
```text
01. Track 1 - 8A (128 BPM)
02. Track 2 - 8A (130 BPM)  ‚Üê –¢–æ—Ç –∂–µ –∫–ª—é—á, –±–ª–∏–∑–∫–∏–π BPM
03. Track 3 - 9A (130 BPM)  ‚Üê +1 –Ω–∞ Camelot Wheel
04. Track 4 - 9B (132 BPM)  ‚Üê –ü–µ—Ä–µ—Ö–æ–¥ –≤ major
```

## üîß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### Debug —Ä–µ–∂–∏–º

```bash
# –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
python reorder_playlist.py "TOKEN" --debug
python prepare_dj_set.py "TOKEN" --debug
```

### –ß–∞—Å—Ç–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–ï—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω Key detection (—ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è):

```python
# –í analyze_audio.py –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:
# HAS_ESSENTIA = False
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö DJ —Å–æ—Ñ—Ç–æ–≤

- **Rekordbox**: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç M3U8 —Å BPM/Key
- **Serato**: –°–æ–∑–¥–∞–π—Ç–µ crate –∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ M3U8
- **Traktor**: Import Playlist ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ M3U8

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–µ–π–ª–∏—Å—Ç–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è:

```text
–í—Å–µ–≥–æ —Ç—Ä–µ–∫–æ–≤:     50
–û–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 4.9 —á–∞—Å–æ–≤

–ñ–∞–Ω—Ä—ã:
  techno           19 —Ç—Ä–µ–∫–æ–≤
  house            13 —Ç—Ä–µ–∫–æ–≤
  dance            11 —Ç—Ä–µ–∫–æ–≤

BPM –¥–∏–∞–ø–∞–∑–æ–Ω: 120.0 - 135.0
–°—Ä–µ–¥–Ω–∏–π BPM:  127.5

–¢–æ–ø-5 –ª–µ–π–±–ª–æ–≤:
  DENSE AUDIO      3 —Ç—Ä–µ–∫–∞
  Alula Tunes      2 —Ç—Ä–µ–∫–∞
  ...
```

## üêõ Troubleshooting

### librosa —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# macOS
brew install libsndfile

# Linux
sudo apt-get install libsndfile1
```

### essentia –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

Essentia –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ. BPM –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –Ω–µ—ë.
–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker:

```bash
docker pull mtgupf/essentia
```

### –§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
1. `music_download/` –∏ `dj_set_techno_2025/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –ó–∞–ø—É—Å—Ç–∏–ª–∏ `reorder_playlist.py` –ø–µ—Ä–µ–¥ `analyze_audio.py`

## üìù TODO

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Beatport API –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ —Ç—Ä–µ–∫–∞ (0-10)
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è waveform preview (PNG)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç Rekordbox XML
- [ ] Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫. –£–≤–∞–∂–∞–π—Ç–µ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞.
